import{_ as s,o as n,c as a,d as p}from"./app-HBA039kk.js";const o="/assets/20240311171239-NpiJX0hw.png",e="/assets/20240311171811-7gih4KyG.png",t="/assets/20240311173941-s22SRvIJ.png",l="/assets/20240311174525-J4d2l_oi.png",c="/assets/20240312101936-McPelZmp.png",k="/assets/20240312102533-IeCSeqnk.png",r={},d=p('<h1 id="sql经典实例" tabindex="-1"><a class="header-anchor" href="#sql经典实例"><span>sql经典实例</span></a></h1><h2 id="case表达式" tabindex="-1"><a class="header-anchor" href="#case表达式"><span><code>CASE</code>表达式</span></a></h2><h3 id="将已有列转换为其它列并进行统计" tabindex="-1"><a class="header-anchor" href="#将已有列转换为其它列并进行统计"><span>将已有列转换为其它列并进行统计</span></a></h3><p>现有月度销售额数据表，如下：</p><p><img src="'+o+`" alt=""></p><p>需要统计季度销售额数据，可以使用<code>CASE</code>表达式，将月度转换为季度，然后进行分组统计。标准sql如下：</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token string">&#39;一季度&#39;</span> 
             <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">6</span> <span class="token keyword">THEN</span> <span class="token string">&#39;二季度&#39;</span>
             <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">9</span> <span class="token keyword">THEN</span> <span class="token string">&#39;三季度&#39;</span>
             <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">12</span> <span class="token keyword">THEN</span> <span class="token string">&#39;四季度&#39;</span>
             <span class="token keyword">ELSE</span> <span class="token string">&#39;其它&#39;</span>
	    <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> season<span class="token punctuation">,</span>
        <span class="token function">sum</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> amount
<span class="token keyword">FROM</span> t_sales_amount
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token string">&#39;一季度&#39;</span> 
               <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">6</span> <span class="token keyword">THEN</span> <span class="token string">&#39;二季度&#39;</span>
               <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">9</span> <span class="token keyword">THEN</span> <span class="token string">&#39;三季度&#39;</span>
               <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">12</span> <span class="token keyword">THEN</span> <span class="token string">&#39;四季度&#39;</span>
               <span class="token keyword">ELSE</span> <span class="token string">&#39;其它&#39;</span>
          <span class="token keyword">END</span><span class="token punctuation">)</span>
</code></pre></div><p>在MySQL或PostgreSQL中，支持下面的简写方式：</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token string">&#39;一季度&#39;</span> 
             <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">6</span> <span class="token keyword">THEN</span> <span class="token string">&#39;二季度&#39;</span>
             <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">9</span> <span class="token keyword">THEN</span> <span class="token string">&#39;三季度&#39;</span>
             <span class="token keyword">WHEN</span> <span class="token string">&quot;month&quot;</span> <span class="token operator">&lt;=</span> <span class="token number">12</span> <span class="token keyword">THEN</span> <span class="token string">&#39;四季度&#39;</span>
             <span class="token keyword">ELSE</span> <span class="token string">&#39;其它&#39;</span>
       <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> season<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> amount
<span class="token keyword">FROM</span> t_sales_amount
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> season
</code></pre></div><p>输出：</p><p><img src="`+e+'" alt=""></p><h3 id="在1条sql中按照不同条件进行统计" tabindex="-1"><a class="header-anchor" href="#在1条sql中按照不同条件进行统计"><span>在1条sql中按照不同条件进行统计</span></a></h3><p>现有各个省份的男女人口数据表，如下：</p><p><img src="'+t+`" alt=""></p><p>需要将各个省份的男女人口数据&quot;行转列&quot;，可以使用<code>CASE</code>表达式，sql如下：</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> province<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> sex <span class="token keyword">WHEN</span> <span class="token string">&#39;男&#39;</span> <span class="token keyword">THEN</span> population <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> population_male<span class="token punctuation">,</span>
	   <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> sex <span class="token keyword">WHEN</span> <span class="token string">&#39;女&#39;</span> <span class="token keyword">THEN</span> population <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> population_female
<span class="token keyword">FROM</span> t_population
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> province
</code></pre></div><p>输出：</p><p><img src="`+l+`" alt=""></p><h3 id="在check约束中定义多个列的条件关系" tabindex="-1"><a class="header-anchor" href="#在check约束中定义多个列的条件关系"><span>在<code>CHECK</code>约束中定义多个列的条件关系</span></a></h3><p>现有员工薪资表，要求限制女性员工的薪资不得超过20000元，可以给给性别列和薪资列添加<code>CHECK</code>约束，sql如下：</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> t_salary
<span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> salary_check
<span class="token keyword">CHECK</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> sex <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span> <span class="token operator">AND</span> salary <span class="token operator">&gt;=</span> <span class="token number">20000</span> <span class="token keyword">THEN</span> <span class="token number">0</span> <span class="token keyword">ELSE</span> <span class="token number">1</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="在update语句中使用case表达式" tabindex="-1"><a class="header-anchor" href="#在update语句中使用case表达式"><span>在<code>UPDATE</code>语句中使用<code>CASE</code>表达式</span></a></h3><p>现有员工薪资表，如下：</p><p><img src="`+c+`" alt=""></p><p>需要调整薪资：</p><ul><li>薪资大于40000的员工，统一下调薪资10%</li><li>薪资小于20000的员工，统一上调薪资10%</li><li>其它员工薪资保持不变</li></ul><p>使用<code>CASE</code>表达式，sql如下：</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> t_salary
<span class="token keyword">SET</span> salary <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> salary <span class="token operator">&gt;</span> <span class="token number">40000</span> <span class="token keyword">THEN</span> salary <span class="token operator">*</span> <span class="token number">0.9</span> <span class="token keyword">WHEN</span> salary <span class="token operator">&lt;</span> <span class="token number">20000</span> <span class="token keyword">THEN</span> salary <span class="token operator">*</span> <span class="token number">1.1</span> <span class="token keyword">ELSE</span> salary <span class="token keyword">END</span><span class="token punctuation">)</span>
</code></pre></div><p>结果：</p><p><img src="`+k+'" alt=""></p>',30),u=[d];function i(y,E){return n(),a("div",null,u)}const g=s(r,[["render",i],["__file","sql经典实例.html.vue"]]);export{g as default};
